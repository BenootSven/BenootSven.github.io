var RecipesList = new Array(
    "oreo",
    "chicken",
    "soup",
    "beef",
    "stew",
    "cake",
    "sausage",
    "pork",
    "ham",
    "veal",
    "duck",
    "lamb",
    "cod",
    "pollock",
    "eel",
    "salmon",
    "tuna",
    "trout",
    "pita",
    "macaroni",
    "pasta",
    "bread",
    "wheat",
    "shrimp",
    "crab",
    "mussel",
    "calamari",
    "chocolate",
    "apple",
    "pudding",
    "nutella"
)

var RandomRecipe = RecipesList[Math.floor((Math.random() * RecipesList.length) + 0)];
Onstart();

//functie die wordt uitgevoerd als javascript start
function Onstart() {
    var HTTPhandeler = new XMLHttpRequest();
    HTTPhandeler.open("GET", "https://api.edamam.com/search?q=" + RandomRecipe + "&from=0&to=25", false);
    HTTPhandeler.send(null);

    var recipes = JSON.parse(HTTPhandeler.response);

    for (var i = 0; i < recipes.to; i++) {
        var strVar = "";
        strVar += "<div class=\"grid__item\">";
        strVar += "<div class=\"recipe__body\">";
        strVar += "<img class=\"recipe__body--image\" src=\"" + recipes.hits[i].recipe.image + "\" alt=\"\">";
        strVar += "<div class=\"recipe__body--description\">";
        strVar += "<h2>";
        strVar += recipes.hits[i].recipe.label;
        strVar += "<\/h2>";
        strVar += "<div class=\"recipe__body--DescriptionContent\">";
        strVar += "<p>";
        strVar += "<span>Calories:<\/span>" + "  " + parseFloat(recipes.hits[i].recipe.calories).toFixed(2) + " (cal)";
        strVar += "<\/p>";
        strVar += "<p>";
        strVar += "<span>Weight:<\/span>" + "  " + parseFloat(recipes.hits[i].recipe.totalWeight).toFixed(2) + " (g)";
        strVar += "<\/p>";
        strVar += "<p>";
        strVar += "<span>Link:<\/span>";
        strVar += "<a class=\"Link\" target=\"_blank\" href=\"" + recipes.hits[i].recipe.url + "\">" + "  " + recipes.hits[i].recipe.source + "<\/a>";
        strVar += "<\/p>";
        strVar += "<\/div>";
        strVar += "<\/div>";
        strVar += "<\/div>";
        strVar += "<\/div>";
        document.getElementById('Grid_Main').insertAdjacentHTML('beforeend', strVar);
    }
}

//functie voor het ophalen van Gulten vrij switch
var valueSwitch = false;
var Checkbox = document.getElementById('CheckboxGlutenFree');
Checkbox.addEventListener("change", function () {
    var state = document.getElementById("CheckboxGlutenFree").checked;
    console.log(state);
    valueSwitch = state;
    CallAPIsearched(textSearched, valueSwitch);
})

//functie die wordt uitgevoerd als je op de button search klikt
var textSearched = RandomRecipe;
var ButtonElement = document.getElementById('nameSearch');
ButtonElement.addEventListener("click", function () {
    var Searched = document.getElementById("InputName");
    textSearched = Searched.value;
    console.log(textSearched);
    CallAPIsearched(textSearched, valueSwitch);
})

//functie die wordt uitgevoerd als je op enter drukt in de search balk
var inputElement = document.getElementById('InputName');
inputElement.addEventListener('keypress', function (e) {
    if (e.keyCode == 13) {
        var Searched = document.getElementById("InputName");
        textSearched = Searched.value;
        console.log(textSearched);
        CallAPIsearched(textSearched, valueSwitch);
    }
})

//functie die wordt uitgevoerd als de waarde van de slider veranderdt
var sliderValue = 25;
var CurrentSet = document.getElementById('CurrentSet');
var slider = document.getElementById("myRange");
CurrentSet.innerHTML = slider.value;
slider.oninput = function () {
    CurrentSet.innerHTML = this.value;
}
slider.addEventListener("change", function () {
    var slider = document.getElementById('myRange');
    console.log(slider.value);
    sliderValue = slider.value;
    CallAPIsearched(textSearched, valueSwitch);
})

//functie die recepten uit de api haalt
function CallAPIsearched(input, valueSwitch) {
    var HTTPhandeler = new XMLHttpRequest();
    HTTPhandeler.open("GET", "https://api.edamam.com/search?q=" + input + "&from=0&to=" + sliderValue + "&health=gluten-free", false);
    HTTPhandeler.send(null);
    var recipes = JSON.parse(HTTPhandeler.response);

    if (recipes.count == 0) {
        var node = document.getElementById('Grid_Main');
        while (node.hasChildNodes()) {
            node.removeChild(node.firstChild);
        }
        console.log("nothing found!");
        var strVar = "";
        strVar += "<p class=\"NothingFoundText\">";
        strVar += "Nothing Found!";
        strVar += "<\/p>";
        document.getElementById('Grid_Main').insertAdjacentHTML('beforeend', strVar);
    }

    else {
        if (valueSwitch == false) {
            console.log("load api none gluten free");
            var HTTPhandeler = new XMLHttpRequest();
            HTTPhandeler.open("GET", "https://api.edamam.com/search?q=" + input + "&from=0&to=" + sliderValue, false);
            HTTPhandeler.send(null);
            var recipes = JSON.parse(HTTPhandeler.response);
            var node = document.getElementById('Grid_Main');
            while (node.hasChildNodes()) {
                node.removeChild(node.firstChild);
            }

            for (var i = 0; i < recipes.to; i++) {
                var strVar = "";
                strVar += "<div class=\"grid__item\">";
                strVar += "<div class=\"recipe__body\">";
                strVar += "<img class=\"recipe__body--image\" src=\"" + recipes.hits[i].recipe.image + "\" alt=\"\">";
                strVar += "<div class=\"recipe__body--description\">";
                strVar += "<h2>";
                strVar += recipes.hits[i].recipe.label;
                strVar += "<\/h2>";
                strVar += "<div class=\"recipe__body--DescriptionContent\">";
                strVar += "<p>";
                strVar += "<span>Calories:<\/span>" + "  " + parseFloat(recipes.hits[i].recipe.calories).toFixed(2) + " (cal)";
                strVar += "<\/p>";
                strVar += "<p>";
                strVar += "<span>Weight:<\/span>" + "  " + parseFloat(recipes.hits[i].recipe.totalWeight).toFixed(2) + " (g)";
                strVar += "<\/p>";
                strVar += "<p>";
                strVar += "<span>Link:<\/span>";
                strVar += "<a class=\"Link\" target=\"_blank\" href=\"" + recipes.hits[i].recipe.url + "\">" + "  " + recipes.hits[i].recipe.source + "<\/a>";
                strVar += "<\/p>";
                strVar += "<\/div>";
                strVar += "<\/div>";
                strVar += "<\/div>";
                strVar += "<\/div>";
                document.getElementById('Grid_Main').insertAdjacentHTML('beforeend', strVar);
            }
        }

        if (valueSwitch == true) {
            console.log("load api gluten free");
            var HTTPhandeler = new XMLHttpRequest();
            HTTPhandeler.open("GET", "https://api.edamam.com/search?q=" + input + "&from=0&to=" + sliderValue + "&health=gluten-free", false);
            HTTPhandeler.send(null);
            var recipes = JSON.parse(HTTPhandeler.response);
            var node = document.getElementById('Grid_Main');
            while (node.hasChildNodes()) {
                node.removeChild(node.firstChild);
            }

            for (var i = 0; i < recipes.to; i++) {
                var strVar = "";
                strVar += "<div class=\"grid__item\">";
                strVar += "<div class=\"recipe__body\">";
                strVar += "<img class=\"recipe__body--image\" src=\"" + recipes.hits[i].recipe.image + "\" alt=\"\">";
                strVar += "<div class=\"recipe__body--description\">";
                strVar += "<h2>";
                strVar += recipes.hits[i].recipe.label;
                strVar += "<\/h2>";
                strVar += "<div class=\"recipe__body--DescriptionContent\">";
                strVar += "<p>";
                strVar += "<span>Calories:<\/span>" + "  " + parseFloat(recipes.hits[i].recipe.calories).toFixed(2) + " (cal)";
                strVar += "<\/p>";
                strVar += "<p>";
                strVar += "<span>Weight:<\/span>" + "  " + parseFloat(recipes.hits[i].recipe.totalWeight).toFixed(2) + " (g)";
                strVar += "<\/p>";
                strVar += "<p>";
                strVar += "<span>Link:<\/span>";
                strVar += "<a class=\"Link\" target=\"_blank\" href=\"" + recipes.hits[i].recipe.url + "\">" + "  " + recipes.hits[i].recipe.source + "<\/a>";
                strVar += "<\/p>";
                strVar += "<\/div>";
                strVar += "<\/div>";
                strVar += "<\/div>";
                strVar += "<\/div>";
                document.getElementById('Grid_Main').insertAdjacentHTML('beforeend', strVar);
            }
        }
    }
}